{% extends "html/base.html" %}
    {% load staticfiles %}
    {% block head %}
    {{ block.super }}
    <link href="{% static "css/program_plan.css" %}" rel="stylesheet" type="text/css">
    {% endblock %}
    {% block body %}
        <h2>Degree Planner - {{ program_plan.program }}</h2>
        <div>
            <input type="button" value="Save" onclick="alert('You can continue the plan later on via ' + window.location.href)">
        </div>  
        <a href="{% url 'polygons.views.program_plan_to_pdf' program_plan.id %}" target="_blank">
           <button class="pure-button smallButton" id="pdf_button">
              Export to PDF
           </button>
        </a>
        <form method="POST" action="{% url 'polygons.views.delete_program_plan' program_plan.id %}" onsubmit="return confirm('Are you sure want to permanently delete this plan?');"> 
           {%csrf_token %}
           <button type="submit" class="pure-button smallButton" id="delete_button">
              Delete Plan
           </button>
        </form>
        </div>
        {% for i in no_of_year %}
            <div class="yearFrame">
                <div class="yearBanner">Year {{ i }}</div>
                {% if i < final_year %}
                    <div class="semesterFrame">
                        <table> 
                            <th>Semester 1</th>
                            {% for subject in subject_list %}
                                {% if subject.semester.abbreviation == "S1" and subject.year == i%}
                                    <tr><td><a href="{{ subject.subject.handbook_link }}" target="_blank">
                                    {{ subject.subject }}</a>
                                    </td></tr>
                                {% endif %}
                            {% endfor %}
                            <tr><td>
                                <form method="POST" action="{% url 'polygons.views.program_plan' program_plan.id %}"> 
                                    {%csrf_token %}
                                    <input type="hidden" name="semester" value="1">
                                    <input type="hidden" name="year" value="{{ i }}">
                                    <input type="submit" value="Add Course"><br><br>
                                </form>
                            </td></tr>
                        </table>
                    </div>  
                    <div class="semesterFrame">
                        <table> 
                            <th>Semester 2</th>
                            {% for subject in subject_list %}
                                {% if subject.semester.abbreviation == "S2" and subject.year == i%}
                                    <tr><td><a href="{{ subject.subject.handbook_link }}" target="_blank">{{ subject.subject }}</a></td></tr>
                                {% endif %}
                            {% endfor %}
                            <tr><td>
                                <form method="POST" action="{% url 'polygons.views.program_plan' program_plan.id %}"> 
                                    {%csrf_token %}
                                    <input type="hidden" name="semester" value="2">
                                    <input type="hidden" name="year" value="{{ i }}">
                                    <input type="submit" value="Add Course"><br><br>
                                </form>
                            </td></tr>
                        </table>
                    </div>
                {% endif %}
                
                {% if i == final_year %}
                    {% if final_semester >= 1 %}
                        <div class="semesterFrame">
                            <table> 
                                <th>Semester 1</th>
                                {% for subject in subject_list %}
                                    {% if subject.semester.abbreviation == "S1" and subject.year == i%}
                                        <tr><td><a href="{{ subject.subject.handbook_link }}" target="_blank">{{ subject.subject }}</a></td></tr>
                                    {% endif %}
                                {% endfor %}
                                <tr><td>
                                    <form method="POST" action="{% url 'polygons.views.program_plan' program_plan.id %}"> 
                                        {%csrf_token %}
                                        <input type="hidden" name="semester" value="1">
                                        <input type="hidden" name="year" value="{{ i }}">
                                        <input type="submit" value="Add Course"><br><br>
                                    </form>
                                </td></tr>
                            </table>
                        </div>
                    {% endif %}
                    {% if final_semester == 2 %}
                        <div class="semesterFrame">
                            <table> 
                                <th>Semester 2</th>
                                {% for subject in subject_list %}
                                    {% if subject.semester.abbreviation == "S2" and subject.year == i%}
                                        <tr><td><a href="{{ subject.subject.handbook_link }}" target="_blank">{{ subject.subject }}</a></td></tr>
                                    {% endif %}
                                {% endfor %}
                                <tr><td>
                                    <form method="POST" action="{% url 'polygons.views.program_plan' program_plan.id %}"> 
                                        {%csrf_token %}
                                        <input type="hidden" name="semester" value="2">
                                        <input type="hidden" name="year" value="{{ i }}">
                                        <input type="submit" value="Add Course"><br><br>
                                    </form>
                                </td></tr>
                            </table>
                        </div>
                    {% endif %}                    
                {% endif %}                    
                <div style="clear: both;"></div>
            </div>
            <div style="clear: both; height: 50px;"></div>
        {% endfor %}

    <h1>
         {{ program_plan.program }}
      </h1>
      <h2>
         Program Plan
      </h2>
      <ul id="years">
         {% for plan_year in plan_years %}
         <li class="year">
            <div class="year_label">
               Year {{ plan_year.year }}
            </div>
            <div class="semesters">
               {% for plan_semester in plan_year %}
               <div class="semester">
                  <div class="semester_label">
                     {{ plan_semester.semester }}
                  </div>
                  <div class="subjects">
                     {% for subject in plan_semester %}
                     <div class="subject">
                        {{ subject }}
                     </div>
                  {% endfor %}
                  </div>
               </div>
               {% endfor %}
            </div>
         </li>
         {% endfor %}
      </ul>


    
      <h1>
         {{ program_plan.program }}
      </h1>
      <h2>
         Program Plan
      </h2>
        {% for plan_year in plan_years %}
            <div class="yearFrame">
                <div class="yearBanner">Year {{ plan_year.year }}</div>
                {% for plan_semester in plan_year %}
                    <div class="semesterFrame">
                        <table> 
                            <th>Semester {{ plan_semester.semester }}</th>
                            {% for subject in plan_semester %}
                            <tr><td><a href="{{ subject.handbook_link }}" target="_blank">{{ subject }}</a></td></tr>

                            {% endfor %}
                        </table>
                    </div>
                {% endfor %}
            </div>
            <div style="clear: both; height: 50px;"></div>
        {% endfor %}
    {% endblock %}
